// //--- ASSINATURA.LIB - COMANDOS PARA IMPRESSAO DE ASSINATURAS EM RELATORIOS E NOTAS DE EMPENHO, LIQUIDACAO E ORDENS ---
OPEN ASSINATU

#IFDEF    ST@ASSINATURA@OPCAO
#ELSE
 STRING   ST@ASSINATURA@OPCAO
#ENDIF
#IFDEF    ST@ASSINATURA@PROGRAMA
#ELSE
 STRING   ST@ASSINATURA@PROGRAMA
#ENDIF
#IFDEF    ST@ASSINATURA@ENTIDADE
#ELSE
 STRING   ST@ASSINATURA@ENTIDADE 2
#ENDIF
#IFDEF    ST@ASSINATURA@EXERCICIO
#ELSE
 STRING   ST@ASSINATURA@EXERCICIO 4
#ENDIF
#IFDEF    ST@ASSINATURA@TITULO1
#ELSE
 STRING   ST@ASSINATURA@TITULO1
#ENDIF
#IFDEF    ST@ASSINATURA@TIPO1
#ELSE
 STRING   ST@ASSINATURA@TIPO1
#ENDIF
#IFDEF    ST@ASSINATURA@NOME1
#ELSE
 STRING   ST@ASSINATURA@NOME1
#ENDIF
#IFDEF    ST@ASSINATURA@CARGO1
#ELSE
 STRING   ST@ASSINATURA@CARGO1
#ENDIF
#IFDEF    ST@ASSINATURA@DOCUMENTO1
#ELSE
 STRING   ST@ASSINATURA@DOCUMENTO1
#ENDIF
#IFDEF    ST@ASSINATURA@TITULO2
#ELSE
 STRING   ST@ASSINATURA@TITULO2
#ENDIF
#IFDEF    ST@ASSINATURA@TIPO2
#ELSE
 STRING   ST@ASSINATURA@TIPO2
#ENDIF
#IFDEF    ST@ASSINATURA@NOME2
#ELSE
 STRING   ST@ASSINATURA@NOME2
#ENDIF
#IFDEF    ST@ASSINATURA@CARGO2
#ELSE
 STRING   ST@ASSINATURA@CARGO2
#ENDIF
#IFDEF    ST@ASSINATURA@DOCUMENTO2
#ELSE
 STRING   ST@ASSINATURA@DOCUMENTO2
#ENDIF
#IFDEF    ST@ASSINATURA@TITULO3
#ELSE
 STRING   ST@ASSINATURA@TITULO3
#ENDIF
#IFDEF    ST@ASSINATURA@TIPO3
#ELSE
 STRING   ST@ASSINATURA@TIPO3
#ENDIF
#IFDEF    ST@ASSINATURA@NOME3
#ELSE
 STRING   ST@ASSINATURA@NOME3
#ENDIF
#IFDEF    ST@ASSINATURA@CARGO3
#ELSE
 STRING   ST@ASSINATURA@CARGO3
#ENDIF
#IFDEF    ST@ASSINATURA@DOCUMENTO3
#ELSE
 STRING   ST@ASSINATURA@DOCUMENTO3
#ENDIF
#IFDEF    ST@ASSINATURA@TITULO4
#ELSE
 STRING   ST@ASSINATURA@TITULO4
#ENDIF
#IFDEF    ST@ASSINATURA@TIPO4
#ELSE
 STRING   ST@ASSINATURA@TIPO4
#ENDIF
#IFDEF    ST@ASSINATURA@NOME4
#ELSE
 STRING   ST@ASSINATURA@NOME4
#ENDIF
#IFDEF    ST@ASSINATURA@CARGO4
#ELSE
 STRING   ST@ASSINATURA@CARGO4
#ENDIF
#IFDEF    ST@ASSINATURA@DOCUMENTO4
#ELSE
 STRING   ST@ASSINATURA@DOCUMENTO4
#ENDIF
#IFDEF    ST@ASSINATURA@TITULO5
#ELSE
 STRING   ST@ASSINATURA@TITULO5
#ENDIF
#IFDEF    ST@ASSINATURA@TIPO5
#ELSE
 STRING   ST@ASSINATURA@TIPO5
#ENDIF
#IFDEF    ST@ASSINATURA@NOME5
#ELSE
 STRING   ST@ASSINATURA@NOME5
#ENDIF
#IFDEF    ST@ASSINATURA@CARGO5
#ELSE
 STRING   ST@ASSINATURA@CARGO5
#ENDIF
#IFDEF    ST@ASSINATURA@DOCUMENTO5
#ELSE
 STRING   ST@ASSINATURA@DOCUMENTO5
#ENDIF
#IFDEF    IT@ASSINATURA
#ELSE
 INTEGER  IT@ASSINATURA
#ENDIF
#IFDEF    IT@ASSINATURA@CONTADOR
#ELSE
 INTEGER  IT@ASSINATURA@CONTADOR
#ENDIF
#IFDEF    IT@ASSINATURA@QTD
#ELSE
 INTEGER  IT@ASSINATURA@QTD
#ENDIF
#IFDEF    DT@ASSINATURA
#ELSE
 DATE     DT@ASSINATURA
#ENDIF
#IFDEF    ST@ASSINATURA@DOC
#ELSE
 STRING   ST@ASSINATURA@DOC 18
#ENDIF

INDICATE TCEMG! FALSE
INDICATE TCEMG! AS PARGERAL.ESTADO EQ 'MG'

//--
//-- !1 - opcao
//-- !2 - programa
//-- !3 - entidade
//-- !4 - exercicio
//--
#COMMAND IMPRIME_ASSINATURA
 MOVEALL '' TO ST@ASSINATURA@OPCAO   ST@ASSINATURA@PROGRAMA ST@ASSINATURA@ENTIDADE ST@ASSINATURA@EXERCICIO
 MOVEALL '' TO ST@ASSINATURA@TITULO1 ST@ASSINATURA@TIPO1    ST@ASSINATURA@NOME1    ST@ASSINATURA@CARGO1    ST@ASSINATURA@DOCUMENTO1
 MOVEALL '' TO ST@ASSINATURA@TITULO2 ST@ASSINATURA@TIPO2    ST@ASSINATURA@NOME2    ST@ASSINATURA@CARGO2    ST@ASSINATURA@DOCUMENTO2
 MOVEALL '' TO ST@ASSINATURA@TITULO3 ST@ASSINATURA@TIPO3    ST@ASSINATURA@NOME3    ST@ASSINATURA@CARGO3    ST@ASSINATURA@DOCUMENTO3
 MOVEALL '' TO ST@ASSINATURA@TITULO4 ST@ASSINATURA@TIPO4    ST@ASSINATURA@NOME4    ST@ASSINATURA@CARGO4    ST@ASSINATURA@DOCUMENTO4
 MOVEALL '' TO ST@ASSINATURA@TITULO5 ST@ASSINATURA@TIPO5    ST@ASSINATURA@NOME5    ST@ASSINATURA@CARGO5    ST@ASSINATURA@DOCUMENTO5
 
 MOVE !1 TO ST@ASSINATURA@OPCAO
 MOVE !2 TO ST@ASSINATURA@PROGRAMA
 MOVE !3 TO ST@ASSINATURA@ENTIDADE
 MOVE !4 TO ST@ASSINATURA@EXERCICIO
 
 MOVEALL 0  TO IT@ASSINATURA IT@ASSINATURA@QTD
 CLEAR ASSINATU
 MOVE ST@ASSINATURA@ENTIDADE  TO ASSINATU.COD_ENTIDADE
 MOVE ST@ASSINATURA@EXERCICIO TO ASSINATU.EXERCICIO
 MOVE ST@ASSINATURA@PROGRAMA  TO ASSINATU.PROGRAMA
 FIND EQ ASSINATU BY INDEX.1
 [ FOUND] BEGIN
           IF ASSINATU.ASSINATURA_1 NE '' INCREMENT IT@ASSINATURA
           IF ASSINATU.ASSINATURA_2 NE '' INCREMENT IT@ASSINATURA
           IF ASSINATU.ASSINATURA_3 NE '' INCREMENT IT@ASSINATURA
           IF ASSINATU.ASSINATURA_4 NE '' INCREMENT IT@ASSINATURA
           IF ASSINATU.ASSINATURA_5 NE '' INCREMENT IT@ASSINATURA
           
           INDICATE CENTRALIZA! AS IT@ASSINATURA LT 3
           [ CENTRALIZA!] BEGIN
                           IF IT@ASSINATURA EQ 1 BEGIN
                                                  CLEAR MENUUSER
                                                  MOVE ASSINATU.ASSINATURA_1 TO MENUUSER.CODIGO
                                                  FIND EQ MENUUSER BY INDEX.1
                                                  
                                                  MOVE '2'            TO ST@ASSINATURA@TIPO2
                                                  MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME2
                                                  MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO2
                                                  DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO2 MENUUSER.MATRICULA
                                                  INCREMENT IT@ASSINATURA@QTD
                                                 END
                           IF IT@ASSINATURA EQ 2 BEGIN
                                                  CLEAR MENUUSER
                                                  MOVE ASSINATU.ASSINATURA_1 TO MENUUSER.CODIGO
                                                  FIND EQ MENUUSER BY INDEX.1

                                                  MOVE '1'            TO ST@ASSINATURA@TIPO1
                                                  MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME1
                                                  MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO1
                                                  DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO1 MENUUSER.MATRICULA
                                                  INCREMENT IT@ASSINATURA@QTD

                                                  CLEAR MENUUSER
                                                  MOVE ASSINATU.ASSINATURA_2 TO MENUUSER.CODIGO
                                                  FIND EQ MENUUSER BY INDEX.1

                                                  MOVE '3'            TO ST@ASSINATURA@TIPO3
                                                  MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME3
                                                  MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO3
                                                  DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO3 MENUUSER.MATRICULA
                                                  INCREMENT IT@ASSINATURA@QTD
                                                 END
                          END
           [~CENTRALIZA!] BEGIN
                           MOVE 0 TO IT@ASSINATURA@CONTADOR
                           FOR IT@ASSINATURA@CONTADOR FROM 1 TO IT@ASSINATURA
                            CLEAR MENUUSER
                            IF IT@ASSINATURA@CONTADOR EQ 1 MOVE ASSINATU.ASSINATURA_1 TO MENUUSER.CODIGO
                            IF IT@ASSINATURA@CONTADOR EQ 2 MOVE ASSINATU.ASSINATURA_2 TO MENUUSER.CODIGO
                            IF IT@ASSINATURA@CONTADOR EQ 3 MOVE ASSINATU.ASSINATURA_3 TO MENUUSER.CODIGO
                            IF IT@ASSINATURA@CONTADOR EQ 4 MOVE ASSINATU.ASSINATURA_4 TO MENUUSER.CODIGO
                            IF IT@ASSINATURA@CONTADOR EQ 5 MOVE ASSINATU.ASSINATURA_5 TO MENUUSER.CODIGO
                            FIND EQ MENUUSER BY INDEX.1

                            IF IT@ASSINATURA@CONTADOR EQ 1 BEGIN
                                                            MOVE '1'            TO ST@ASSINATURA@TIPO1
                                                            MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME1
                                                            MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO1
                                                            DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO1 MENUUSER.MATRICULA
                                                            INCREMENT IT@ASSINATURA@QTD
                                                           END
                            IF IT@ASSINATURA@CONTADOR EQ 2 BEGIN
                                                            MOVE '2'            TO ST@ASSINATURA@TIPO2
                                                            MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME2
                                                            MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO2
                                                            DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO2 MENUUSER.MATRICULA
                                                            INCREMENT IT@ASSINATURA@QTD
                                                           END
                            IF IT@ASSINATURA@CONTADOR EQ 3 BEGIN
                                                            MOVE '3'            TO ST@ASSINATURA@TIPO3
                                                            MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME3
                                                            MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO3
                                                            DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO3 MENUUSER.MATRICULA
                                                            INCREMENT IT@ASSINATURA@QTD
                                                           END
                            IF IT@ASSINATURA@CONTADOR EQ 4 BEGIN
                                                            MOVE '4'            TO ST@ASSINATURA@TIPO4
                                                            MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME4
                                                            MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO4
                                                            DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO4 MENUUSER.MATRICULA
                                                            INCREMENT IT@ASSINATURA@QTD
                                                           END
                            IF IT@ASSINATURA@CONTADOR EQ 5 BEGIN
                                                            MOVE '5'            TO ST@ASSINATURA@TIPO5
                                                            MOVE MENUUSER.NOME  TO ST@ASSINATURA@NOME5
                                                            MOVE MENUUSER.CARGO TO ST@ASSINATURA@CARGO5
                                                            DEFINE_DOC_ASSINATURA MENUUSER.CIC_CPF MENUUSER.C_R_C ST@ASSINATURA@DOCUMENTO5 MENUUSER.MATRICULA
                                                            INCREMENT IT@ASSINATURA@QTD
                                                           END
                           LOOP
                          END
          END
#ENDCOMMAND
