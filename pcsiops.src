/TELA RESIDENT
 __/__/____  ________________________________________________________         
팠袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴袴孤
                                                                              
                                                                                                                                                                                 
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
                                                                              
쳐컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
                             <ESC> Retorna                                    
읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
/TELA_COMPLETA RESIDENT
                                                                              
                                                                              
 Contas do Exerc죅io     ____                                                 
                                                                              
                                                                              
 C줰igo                  ____________________               Tipo _   Grau _   
                                                                              
                                                                              
 Descri뇙o               __________________________________________________   
                         __________________________________________________   
                         __________________________________________________   
                         __________________________________________________   
                                                                              
                                                                              
 C줰igo Item             _____.                 Linha _____    Coluna _____   
                                                                              
쳐컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
______________________________________________________________________________
읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
/TELA_PESQUISA RESIDENT
______________________________________________________________________________
쳐컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
______________________________________________________________________________
쳐컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
<Enter>Completa             <F2>Mostra Relacionamento             <ESC>Retorna
읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
/BUFFER RESIDENT
T  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
1  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
2  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
3  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
4  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
5  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
6  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
7  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
8  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
9  ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
10 ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
11 ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
12 ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
13 ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
14 ________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
/TELA_RECNUM RESIDENT
TITULO _________.
1      _________.
2      _________.
3      _________.
4      _________.
5      _________.
6      _________.
7      _________.
8      _________.
9      _________.
10     _________.
11     _________.
12     _________.
13     _________.
14     _________.
/FANTASMA RESIDENT
___________,___.__
/SELECAO RESIDENT
旼컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴커
                 Entre com o EXERC좧IO desejado ____                        
                                                                            
       Entre com a NATUREZA desejada  _ <R>ECEITA   / <D>ESPESA             
                                        <S>UBFUNCAO / <C>OVID               
                                                                            
쿐ntre com o CODIGO inicial desejado ________________ <ENTER> para o primeiro
읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
/CONFIRMA RESIDENT
쳐컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴캑
______________________________________________________________________________
읕컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴컴켸
/*
#INCLUDE CONAM.LIB

STRING ST_MONTALINHA 240 ST@LINHA 240 ST_CODIGO ST_DESCRICAO 45 ST_NATUREZA ST_DESTINO 255 ST_NATUREZA_FINAL ST_NATUREZA_TIPO
STRING ST_SISTEMA

INTEGER IT_CONTADOR IT@LINHAS  IT_JANELA IT_RECNUM

#COMMAND MONTALINHA
 MOVE CADSIOP.DESCRICAO TO ST_DESCRICAO

 MOVE '' TO ST@LINHA
 [ DESPESA!] BEGIN
              APPEND ST@LINHA 'Ano   C줰igo              Descri뇙o                                     Tp Gr'
              PAD CADSIOP.CODIGO TO ST_CODIGO 19
             END
 [ RECEITA!] BEGIN
              APPEND ST@LINHA 'Ano   C줰igo           Descri뇙o                                     Tp Gr'
              PAD CADSIOP.CODIGO TO ST_CODIGO 16
             END
 [ SUBFUNCAO!] BEGIN
                APPEND ST@LINHA 'Ano C줰igo  Descri뇙o'
                PAD CADSIOP.CODIGO TO ST_CODIGO 5
               END
 [ COVID!] BEGIN
            APPEND ST@LINHA 'Ano  Natureza        C줰igo     Descri뇙o'
                 IF CADSIOP.NATUREZA EQ 'COVID_D_ESTADO'  MOVE 'DESPESA ESTADO'  TO ST_NATUREZA_TIPO
            ELSE IF CADSIOP.NATUREZA EQ 'COVID_D_UNIAO'   MOVE 'DESPESA UNIAO'   TO ST_NATUREZA_TIPO
            ELSE IF CADSIOP.NATUREZA EQ 'COVID_D_PROPRIO' MOVE 'DESPESA PROPRIO' TO ST_NATUREZA_TIPO
            ELSE IF CADSIOP.NATUREZA EQ 'COVID_R_ESTADO'  MOVE 'RECEITA ESTADO'  TO ST_NATUREZA_TIPO
            ELSE IF CADSIOP.NATUREZA EQ 'COVID_R_UNIAO'   MOVE 'RECEITA UNIAO'   TO ST_NATUREZA_TIPO
            ELSE IF CADSIOP.NATUREZA EQ 'COVID_R_PROPRIO' MOVE 'RECEITA PROPRIO' TO ST_NATUREZA_TIPO
            
            PAD ST_NATUREZA_TIPO TO ST_NATUREZA_TIPO 15
            PAD CADSIOP.CODIGO   TO ST_CODIGO   10
           END

 MOVE ST@LINHA TO JN_BUFFER_TITULO
 MOVE '' TO ST_MONTALINHA
 [~COVID!] APPEND ST_MONTALINHA  CADSIOP.ANO '  ' ST_CODIGO ' ' ST_DESCRICAO ' ' CADSIOP.TIPO '  ' CADSIOP.GRAU
 [ COVID!] APPEND ST_MONTALINHA  CADSIOP.ANO ' ' ST_NATUREZA_TIPO ' '  ST_CODIGO ' ' ST_DESCRICAO ' ' CADSIOP.TIPO '  ' CADSIOP.GRAU
#ENDCOMMAND

#COMMAND SOBE_1
  MOVE JN_BUFFER_2  TO JN_BUFFER_1
  MOVE JN_BUFFER_3  TO JN_BUFFER_2
  MOVE JN_BUFFER_4  TO JN_BUFFER_3
  MOVE JN_BUFFER_5  TO JN_BUFFER_4
  MOVE JN_BUFFER_6  TO JN_BUFFER_5
  MOVE JN_BUFFER_7  TO JN_BUFFER_6
  MOVE JN_BUFFER_8  TO JN_BUFFER_7
  MOVE JN_BUFFER_9  TO JN_BUFFER_8
  MOVE JN_BUFFER_10 TO JN_BUFFER_9
  MOVE JN_BUFFER_11 TO JN_BUFFER_10
  MOVE JN_BUFFER_12 TO JN_BUFFER_11
  MOVE JN_BUFFER_13 TO JN_BUFFER_12
  MOVE JN_BUFFER_14 TO JN_BUFFER_13

  MOVE JN_RECNUM_2  TO JN_RECNUM_1
  MOVE JN_RECNUM_3  TO JN_RECNUM_2
  MOVE JN_RECNUM_4  TO JN_RECNUM_3
  MOVE JN_RECNUM_5  TO JN_RECNUM_4
  MOVE JN_RECNUM_6  TO JN_RECNUM_5
  MOVE JN_RECNUM_7  TO JN_RECNUM_6
  MOVE JN_RECNUM_8  TO JN_RECNUM_7
  MOVE JN_RECNUM_9  TO JN_RECNUM_8
  MOVE JN_RECNUM_10 TO JN_RECNUM_9
  MOVE JN_RECNUM_11 TO JN_RECNUM_10
  MOVE JN_RECNUM_12 TO JN_RECNUM_11
  MOVE JN_RECNUM_13 TO JN_RECNUM_12
  MOVE JN_RECNUM_14 TO JN_RECNUM_13
#ENDCOMMAND

#COMMAND DESCE_1
  MOVE JN_BUFFER_13 TO JN_BUFFER_14
  MOVE JN_BUFFER_12 TO JN_BUFFER_13
  MOVE JN_BUFFER_11 TO JN_BUFFER_12
  MOVE JN_BUFFER_10 TO JN_BUFFER_11
  MOVE JN_BUFFER_9  TO JN_BUFFER_10
  MOVE JN_BUFFER_8  TO JN_BUFFER_9
  MOVE JN_BUFFER_7  TO JN_BUFFER_8
  MOVE JN_BUFFER_6  TO JN_BUFFER_7
  MOVE JN_BUFFER_5  TO JN_BUFFER_6
  MOVE JN_BUFFER_4  TO JN_BUFFER_5
  MOVE JN_BUFFER_3  TO JN_BUFFER_4
  MOVE JN_BUFFER_2  TO JN_BUFFER_3
  MOVE JN_BUFFER_1  TO JN_BUFFER_2

  MOVE JN_RECNUM_13 TO JN_RECNUM_14
  MOVE JN_RECNUM_12 TO JN_RECNUM_13
  MOVE JN_RECNUM_11 TO JN_RECNUM_12
  MOVE JN_RECNUM_10 TO JN_RECNUM_11
  MOVE JN_RECNUM_9  TO JN_RECNUM_10
  MOVE JN_RECNUM_8  TO JN_RECNUM_9
  MOVE JN_RECNUM_7  TO JN_RECNUM_8
  MOVE JN_RECNUM_6  TO JN_RECNUM_7
  MOVE JN_RECNUM_5  TO JN_RECNUM_6
  MOVE JN_RECNUM_4  TO JN_RECNUM_5
  MOVE JN_RECNUM_3  TO JN_RECNUM_4
  MOVE JN_RECNUM_2  TO JN_RECNUM_3
  MOVE JN_RECNUM_1  TO JN_RECNUM_2
#ENDCOMMAND

AUTOPAGE TELA
NAME JN_TARJA_DATA
NAME JN_TARJA_TITULO

AUTOPAGE SELECAO
NAME JN_ANO JN_NATUREZA JN_CODIGO_SELECAO

AUTOPAGE TELA_COMPLETA
NAME JN_EXERCICIO     JN_CODIGO
NAME JN_TIPO          JN_GRAU      JN_DESCRICAO1 JN_DESCRICAO2 JN_DESCRICAO3 JN_DESCRICAO4
NAME JN_COD_ITEM      JN_LINHA     JN_COLUNA
NAME JN_RODAPE

AUTOPAGE TELA_PESQUISA
NAME JN_TITULO
NAME JN_LINHA_1
NAME JN_LINHA_2
NAME JN_LINHA_3
NAME JN_LINHA_4
NAME JN_LINHA_5
NAME JN_LINHA_6
NAME JN_LINHA_7
NAME JN_LINHA_8
NAME JN_LINHA_9
NAME JN_LINHA_10
NAME JN_LINHA_11
NAME JN_LINHA_12
NAME JN_LINHA_13
NAME JN_LINHA_14

AUTOPAGE BUFFER
NAME JN_BUFFER_TITULO
NAME JN_BUFFER_1
NAME JN_BUFFER_2
NAME JN_BUFFER_3
NAME JN_BUFFER_4
NAME JN_BUFFER_5
NAME JN_BUFFER_6
NAME JN_BUFFER_7
NAME JN_BUFFER_8
NAME JN_BUFFER_9
NAME JN_BUFFER_10
NAME JN_BUFFER_11
NAME JN_BUFFER_12
NAME JN_BUFFER_13
NAME JN_BUFFER_14

AUTOPAGE TELA_RECNUM
NAME JN_RECNUM_TITULO
NAME JN_RECNUM_1
NAME JN_RECNUM_2
NAME JN_RECNUM_3
NAME JN_RECNUM_4
NAME JN_RECNUM_5
NAME JN_RECNUM_6
NAME JN_RECNUM_7
NAME JN_RECNUM_8
NAME JN_RECNUM_9
NAME JN_RECNUM_10
NAME JN_RECNUM_11
NAME JN_RECNUM_12
NAME JN_RECNUM_13
NAME JN_RECNUM_14

OPEN CADSIOP
OPEN RELSIOP

PAGE SET CONFIRMA       AT 21 00  COLORS IT_COR_TARJA  IT_COR_MOLDURA
PAGE SET TELA           AT 03 00  COLORS IT_COR_TARJA  IT_COR_MOLDURA
PAGE SET SELECAO        AT 10 01  COLORS IT_COR_TARJA  IT_COR_TITULO
PAGE SET TELA_PESQUISA  AT 05 00  COLORS IT_COR_TARJA  IT_COR_MOLDURA
PAGE SET TELA_COMPLETA  AT 05 00  COLORS IT_COR_TARJA  IT_COR_MOLDURA

SCREENMODE IT_COR_MOLDURA ON
SYSDATA JN_TARJA_DATA
SCREENMODE IT_COR_TITULO ON
CABEC 'PESQUISA DE RECEITAS E DESPESAS - SIOPS' JN_TARJA_TITULO
SCREENMODE IT_COR_TARJA ON

INICIO:
KEYPROC OFF
PAGE TELA
PAGE SELECAO

// IF ST@CODIGO@ENTIDADE NE '01' BEGIN
//                                ADVERTE 'PROGRAMA INDISPONIVEL PARA ESTA ENTIDADE'
//                                ABORT
//                               END

SCREENMODE IT_COR_TARJA ON
CLEARFORM JN_ANO THRU JN_CODIGO_SELECAO

MOVE PARGERAL.EXERCICIO TO JN_ANO

LB_ANO:
REPEAT
 ANO_2000 JN_ANO {AUTOCLEAR}
 [ KEY.ESCAPE] ABORT
 [ KEY.UP] GOTO LB_ANO
UNTIL JN_ANO NE ''

LB_NATUREZA:
REPEAT
 ACCEPT JN_NATUREZA {AUTOCLEAR,CAPSLOCK}
 [ KEY.ESCAPE] ABORT
 [ KEY.UP] GOTO LB_ANO
 IF NOT JN_NATUREZA IN 'RDSC' MOVE '' TO JN_NATUREZA
UNTIL JN_NATUREZA NE ''

INDICATE RECEITA!   AS JN_NATUREZA EQ 'R'
INDICATE DESPESA!   AS JN_NATUREZA EQ 'D'
INDICATE SUBFUNCAO! AS JN_NATUREZA EQ 'S'
INDICATE COVID!     AS JN_NATUREZA EQ 'C'

ACCEPT JN_CODIGO_SELECAO {AUTOCLEAR}
[ KEY.ESCAPE] ABORT
[ KEY.UP] GOTO LB_NATUREZA

[ DESPESA!] BEGIN
 PONTUA_ECONOMICA JN_CODIGO_SELECAO
 MOVE 'DESPESA' TO ST_NATUREZA
 MOVE 'DESPESA' TO ST_NATUREZA_FINAL
 END
[ RECEITA!] BEGIN
 PONTUA_RECEITA JN_CODIGO_SELECAO JN_ANO
 MOVE 'RECEITA' TO ST_NATUREZA
 MOVE 'RECEITA' TO ST_NATUREZA_FINAL
 END
[ SUBFUNCAO!] BEGIN
 MOVE 'SUBFUNCAO' TO ST_NATUREZA
 MOVE 'SUBFUNCAO' TO ST_NATUREZA_FINAL
 END
[ COVID!] BEGIN
 MOVE 'COVID'   TO ST_NATUREZA
 MOVE 'COVID_X' TO ST_NATUREZA_FINAL
 END

MOVE 'SIOPS' TO ST_SISTEMA
 
CLEAR CADSIOP
MOVE ST_SISTEMA        TO CADSIOP.SISTEMA
MOVE JN_ANO            TO CADSIOP.ANO
MOVE ST_NATUREZA       TO CADSIOP.NATUREZA
MOVE JN_CODIGO_SELECAO TO CADSIOP.CODIGO
FIND EQ CADSIOP BY INDEX.1
[~FOUND] BEGIN
          FIND GT CADSIOP BY INDEX.1
          [ FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
          [ FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
          [ FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
          [ FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
          [~FOUND] BEGIN
                    DISPENSA 357
                   END
         END

FIND LT CADSIOP BY INDEX.1
[ FOUND] MOVE CADSIOP.RECNUM TO IT_RECNUM
[~FOUND] MOVE '0'            TO IT_RECNUM

MOVE 0 TO IT_JANELA
SCREENMODE IT_COR_MOLDURA ON

LB_ROTINA_INICIO:

 CLEARFORM JN_BUFFER_1 THRU JN_BUFFER_14
 CLEARFORM JN_RECNUM_1 THRU JN_RECNUM_14

 MOVE 0  TO IT_CONTADOR 
 MOVE 0  TO WINDOWINDEX
 MOVE 14 TO IT@LINHAS

 CLEAR CADSIOP
 MOVE IT_RECNUM TO CADSIOP.RECNUM
 FIND EQ CADSIOP BY RECNUM

FOR IT_CONTADOR FROM 1 TO IT@LINHAS
 FIND GT CADSIOP BY INDEX.1
 [  FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
 [  FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
 [  FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
 [  FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
 [FINDERR] BEGIN
             IF (WINDOWINDEX-1) LT IT_JANELA CALC (WINDOWINDEX-1) TO IT_JANELA
             MOVE IT@LINHAS TO IT_CONTADOR
           END

 [FOUND] BEGIN
          MONTALINHA
          MOVE ST_MONTALINHA  TO JN_BUFFER_1&
          MOVE CADSIOP.RECNUM TO JN_RECNUM_1&
          INCREMENT WINDOWINDEX
         END
LOOP 

 ENCHE_TELA
 PAGE TELA_PESQUISA

 MOVE IT_JANELA      TO WINDOWINDEX
 MOVE CADSIOP.RECNUM TO IT_RECNUM

 REPEAT
  GOSUB ALTA_INTENSIDADE
  INKEY ST_TECLA
  GOSUB BAIXA_INTENSIDADE

  [KEY.RIGHT] BEGIN
               IF IT@POSICAO LE (IT@MAXIMO-76) BEGIN
                                                INCREMENT IT@POSICAO
                                                ENCHE_TELA
                                               END
              END

  [KEY.LEFT] IF IT@POSICAO NE 1 BEGIN
                                 DECREMENT IT@POSICAO
                                 ENCHE_TELA
                                END

  [KEY.ESCAPE] BEGIN
                CLEAR CADSIOP
                GOTO INICIO
               END

  [KEY.UP] BEGIN                            // SET SOBE
            IF WINDOWINDEX NE 0 DECREMENT WINDOWINDEX
            ELSE BEGIN
                  CLEAR CADSIOP
                  MOVE JN_RECNUM_1 TO CADSIOP.RECNUM
                  FIND EQ CADSIOP BY RECNUM
                  FIND LT CADSIOP BY INDEX.1
                  [FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
                  [FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
                  [FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
                  [FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
                  [FOUND] BEGIN
                           DESCE_1
                           MONTALINHA
                           MOVE ST_MONTALINHA  TO JN_BUFFER_1
                           MOVE CADSIOP.RECNUM TO JN_RECNUM_1
                           ENCHE_TELA
                          END
                 END
           END

  [KEY.DOWN] BEGIN                         // SET DESCE
               IF WINDOWINDEX EQ (IT@LINHAS-1) BEGIN
                                                CLEAR CADSIOP
                                                MOVE JN_RECNUM_14 TO CADSIOP.RECNUM
                                                FIND EQ CADSIOP BY RECNUM
                                                FIND GT CADSIOP BY INDEX.1
                                                [FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
                                                [FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
                                                [FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
                                                [FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
                                                [FOUND] BEGIN
                                                         SOBE_1
                                                         MONTALINHA
                                                         MOVE ST_MONTALINHA  TO JN_BUFFER_14
                                                         MOVE CADSIOP.RECNUM TO JN_RECNUM_14
                                                         ENCHE_TELA
                                                        END
                                              END
              ELSE BEGIN
                    INCREMENT WINDOWINDEX
                    IF JN_RECNUM_1& EQ 0 DECREMENT WINDOWINDEX
                   END
            END

  [KEY.NEXT] IF JN_RECNUM_14 NE 0 BEGIN
                                   CLEAR CADSIOP
                                   MOVE JN_RECNUM_14 TO CADSIOP.RECNUM
                                   FIND EQ CADSIOP BY RECNUM
                                   FIND GT CADSIOP BY INDEX.1
                                   [FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
                                   [FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
                                   [FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
                                   [FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
                                   [FOUND] BEGIN
                                            MOVE JN_RECNUM_14 TO IT_RECNUM
                                            MOVE WINDOWINDEX  TO IT_JANELA
                                            GOTO LB_ROTINA_INICIO
                                           END
                                  END

  [KEY.PREVIOUS] BEGIN
                  CLEAR CADSIOP
                  MOVE JN_RECNUM_1 TO CADSIOP.RECNUM
                  FIND EQ CADSIOP BY RECNUM
                  FOR IT_CONTADOR FROM 1 TO (IT@LINHAS+1)
                   FIND LT CADSIOP BY INDEX.1
                   [ FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
                   [ FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
                   [ FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
                   [ FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
                   [~FOUND] MOVE (IT@LINHAS+1)  TO IT_CONTADOR
                   [ FOUND] MOVE CADSIOP.RECNUM TO IT_RECNUM
                  LOOP

                  MOVE WINDOWINDEX TO IT_JANELA

                  [~FOUND] BEGIN
                            CLEAR CADSIOP
                            MOVE ST_SISTEMA  TO CADSIOP.SISTEMA
                            MOVE JN_ANO      TO CADSIOP.ANO
                            MOVE ST_NATUREZA TO CADSIOP.NATUREZA
                            FIND GT CADSIOP BY INDEX.1
                            [ FOUND] INDICATE FOUND AS CADSIOP.SISTEMA  EQ ST_SISTEMA
                            [ FOUND] INDICATE FOUND AS CADSIOP.ANO      EQ JN_ANO
                            [ FOUND] INDICATE FOUND AS CADSIOP.NATUREZA GE ST_NATUREZA
                            [ FOUND] INDICATE FOUND AS CADSIOP.NATUREZA LE ST_NATUREZA_FINAL
                            [ FOUND] BEGIN
                                      FIND LT CADSIOP BY INDEX.1
                                      [ FOUND] MOVE CADSIOP.RECNUM TO IT_RECNUM
                                      [~FOUND] MOVE '0'            TO IT_RECNUM
                                     END
                           END
                  GOTO LB_ROTINA_INICIO
                 END

//   [ KEY.PRINT] BEGIN
//                 GOTO LB_CONTINUA
//                 
//                 CLEAR CADSIOP
//                 MOVE JN_RECNUM_1& TO CADSIOP.RECNUM
//                 FIND EQ CADSIOP BY RECNUM
//                
//                 MOVE 'CADSIOP 1 ' TO ST_DESTINO
//                 APPEND ST_DESTINO  ST@USUARIO ' ' ST@OPCAO ' ' ST@PROGRAMA ' ' ST@CODIGO@ENTIDADE ' ' ST@EXERCICIO@FINANCEIRO ' ' CADSIOP.ANO ' ' CADSIOP.NATUREZA ' ' CADSIOP.CODIGO
//                 CHAIN WAIT ST_DESTINO EXPORT_FILES
// 
//                 CLEAR CADSIOP
//                 MOVE JN_RECNUM_1 TO CADSIOP.RECNUM
//                 FIND EQ CADSIOP BY RECNUM
//                 FIND LT CADSIOP BY INDEX.1
//                 [ FOUND] MOVE CADSIOP.RECNUM TO IT_RECNUM
//                 [~FOUND] MOVE 0              TO IT_RECNUM
//                 SCREENMODE IT_COR_MOLDURA ON
//                 MOVE WINDOWINDEX TO IT_JANELA
//                 MOVE 0 TO CURRENT_IMAGE
//                 PAGE TELA
//                 PAGE TELA_PESQUISA
//                 GOTO LB_ROTINA_INICIO
//                END

  [ KEY.RETURN] BEGIN
                 CLEAR CADSIOP
                 MOVE JN_RECNUM_1& TO CADSIOP.RECNUM
                 FIND EQ CADSIOP BY RECNUM

                 SCREENMODE IT_COR_TARJA ON
                 BLANKFORM TELA_COMPLETA

                 MOVE CADSIOP.ANO            TO JN_EXERCICIO
                 MOVE CADSIOP.CODIGO         TO JN_CODIGO
                 
                 MOVE (MID(CADSIOP.DESCRICAO,50,1))   TO JN_DESCRICAO1
                 MOVE (MID(CADSIOP.DESCRICAO,50,51))  TO JN_DESCRICAO2
                 MOVE (MID(CADSIOP.DESCRICAO,50,101)) TO JN_DESCRICAO3
                 MOVE (MID(CADSIOP.DESCRICAO,50,151)) TO JN_DESCRICAO4
                 
                 MOVE CADSIOP.TIPO           TO JN_TIPO
                 MOVE CADSIOP.GRAU           TO JN_GRAU
                 MOVE CADSIOP.CODIGO_ITEM    TO JN_COD_ITEM
                 MOVE CADSIOP.L_ADM_D        TO JN_LINHA
                 MOVE CADSIOP.C_ADM_D        TO JN_COLUNA
                 
                 SCREENMODE IT_COR_MOLDURA ON
                 CABEC 'Qualquer Tecla Para Retornar' JN_RODAPE
                 SCREENMODE IT_COR_TARJA ON
                
                 PAGE TELA_COMPLETA
                 GOTOXY 25 0
                 INKEY ST_TECLA
                 MOVE 0 TO CURRENT_IMAGE
                 SCREENMODE IT_COR_MOLDURA ON
                END

  [ KEY.FIELD] BEGIN
                CLEAR CADSIOP
                MOVE JN_RECNUM_1& TO CADSIOP.RECNUM
                FIND EQ CADSIOP BY RECNUM

                SCREENMODE IT_COR_TARJA ON

                MOVE 'CRELSIOP 1 ' TO ST_DESTINO
                APPEND ST_DESTINO  ST@USUARIO ' ' ST@OPCAO ' ' ST@PROGRAMA ' ' ST@CODIGO@ENTIDADE ' ' ST@EXERCICIO@FINANCEIRO
                CHAIN WAIT ST_DESTINO EXPORT_FILES

                MOVE 0 TO CURRENT_IMAGE
                SCREENMODE IT_COR_MOLDURA ON
               END

LB_CONTINUA:
PAGE TELA_PESQUISA
GOSUB ALTA_INTENSIDADE

LOOP
ABORT

BAIXA_INTENSIDADE:
 SCREENMODE IT_COR_MOLDURA ON
 DISPLAY JN_LINHA_1& TO JN_LINHA_1&
 GOTOXY 25 0
RETURN

ALTA_INTENSIDADE:
 SCREENMODE IT_COR_TITULO ON
 DISPLAY JN_LINHA_1& TO JN_LINHA_1&
 GOTOXY 25 0
RETURN

KEYPROC KEY.HELP
AJUDA
PAGE TELA_PESQUISA
GOTOXY 30 0
RETURN



