/TELA RESIDENT
фмммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммммм╣
Ё                                                                              Ё
Ё                                                                              Ё
цддддддддддддд BALANCETE DE VERIFICA─▌O CONTA CORRENTE - AUDESP ддддддддддддддд╢
Ё                                                                              Ё
Ё                                                                              Ё
ЁEntidade       <F2>: __ _____________________________________________________ Ё
Ё                                                                              Ё
ЁM┬s / Ano desejado  ->  Inicial: __ / ____  Final: __ / ____                  Ё
Ё                                                                              Ё
ЁInforme um C/C <F2>: __ _____________________________________________________ Ё
Ё<ENTER>p/todos                                                                Ё
Ё                                                                              Ё
ЁConta Inicial  <F2>: __________________ _____________________________________ Ё
Ё                                                                              Ё
ЁConta Final    <F2>: __________________ _____________________________________ Ё
Ё                                                                              Ё
цдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё                               <ESC>  Retorna                                 Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
/MSG RESIDENT
здддддддддддд BALANCETE DE VERIFICA─▌O CONTA CORRENTE - AUDESP дддддддддддддд©
Ё                                                                            Ё
цдддддддддддддддддддддддддддддд SOLICITADO дддддддддддддддддддддддддддддддддд╢
Ё                                                                            Ё
Ё                                                                            Ё
Ё              M┬s Inicial : __ / ____   M┬s Final : __ / ____               Ё
Ё                                                                            Ё
Ё                                                                            Ё
цдддддддддддддддддддддддддддддд PROCESSANDO ддддддддддддддддддддддддддддддддд╢
Ё                                                                            Ё
Ё                                                                            Ё
Ё                                                                            Ё
Ё                         Lendo :  __________.                               Ё
Ё                                                                            Ё
Ё                                                                            Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
/CONFIRMA RESIDENT
цдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддд╢
Ё______________________________________________________________________________Ё
юдддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддддды
/fantasma
______________.__
______________.__
______________.__
______________.__
/HEADER
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|                                                                                                                                                                                                                          |
|                                                                         ____________________________________________________________                                                                                     |
|                                                                                                                                                                                                                          |
|                                                                                                                                                                                                                          |
|                                                          BALANCETE DE VERIFICACAO CONTA CORRENTE - PERIODO MES INICIAL __ / ____ MES FINAL __ / ____                                                                     |
|                                                                                                                                                                                                                          |
|                                                                         ____________________________________________________________                                                                                     |
|  DATA   __/__/____                                                      ____________________________________________________________                                                                     Pagina ______.  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|CONTA             |CONTA CORRENTE                                                                                                             |D/C|  SALDO ANTERIOR|          DEBITO|         CREDITO|     SALDO ATUAL|D/C|
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
/BODY RESIDENT
|__________________|___________________________________________________________________________________________________________________________| _ |_________,___.__|_________,___.__|_________,___.__|_________,___.__| _ |
/SUBTOTAL RESIDENT
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                                                                  Subtotal  ->    |_________,___.__|_________,___.__|_________,___.__|_________,___.__|   |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
/TOTAL RESIDENT
                                                                                                                                      Total  ->    |_________,___.__|_________,___.__|_________,___.__|_________,___.__|   |
                                                                                                                                                    -----------------------------------------------------------------------
/FOOTER RESIDENT
 --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
/ASSINATURAS



      ___________________________________      ___________________________________      ___________________________________      ___________________________________      ___________________________________
      ___________________________________      ___________________________________      ___________________________________      ___________________________________      ___________________________________
      ___________________________________      ___________________________________      ___________________________________      ___________________________________      ___________________________________
      ___________________________________      ___________________________________      ___________________________________      ___________________________________      ___________________________________
/*
#INCLUDE CONAM.LIB
#INCLUDE ZERAARQ.LIB
#INCLUDE ASSINATURA.LIB 

DATE DT_DATA

STRING ST_COD_ENTIDADE     2  ST_N_EMPENHO
STRING ST_JUNTA          255  ST_XML               ST_CONTA                ST_DESCRICAO    150
STRING ST_ANO_EMPENHO      4  ST_REGIME_DESPESA    ST_MODALIDADE_LICITACAO ST_N_INSCRICAO      ST_DADOS    255
STRING ST_TIPO_EMPENHO        ST_TIPO_INSCRICAO    ST_CONTA_CORRENTE       ST_EXERCICIO      4 ST_MES

INTEGER IT_CONTADOR IT_RECNUM RECCOUNT IT_AUX IT_MES_INICIAL IT_MES_FINAL IT_QTD

NUMBER NB_SALDO_INICIAL NB_SALDO_FINAL NB_TOTAL_SALDO_INICIAL NB_TOTAL_SALDO_FINAL

AUTOPAGE BODY
NAME JBD_CODIGO        JBD_DESCRICAO JBD_NATUREZA_INICIAL
NAME JBD_SALDO_INICIAL JBD_DEBITO    JBD_CREDITO
NAME JBD_SALDO_FINAL   JBD_NATUREZA_FINAL

AUTOPAGE ASSINATURAS
NAME JT_ASSINATURA_1 JT_ASSINATURA_2 JT_ASSINATURA_3 JT_ASSINATURA_4 JT_ASSINATURA_5
NAME JT_NOME_1       JT_NOME_2       JT_NOME_3       JT_NOME_4       JT_NOME_5
NAME JT_CARGO_1      JT_CARGO_2      JT_CARGO_3      JT_CARGO_4      JT_CARGO_5
NAME JT_CRC_1        JT_CRC_2        JT_CRC_3        JT_CRC_4        JT_CRC_5

AUTOPAGE TELA
NAME JN_COD_ENTIDADE    JN_ENTIDADE
NAME JN_MES_INICIAL     JN_ANO_INICIAL
NAME JN_MES_FINAL       JN_ANO_FINAL
NAME JN_CC              JN_CONTA_CORRENTE
NAME JN_CONTA_INICIAL   JN_INICIAL
NAME JN_CONTA_FINAL     JN_FINAL

AUTOPAGE MSG
NAME JN_MES_SOLICITADO_I JN_ANO_SOLICITADO_I
NAME JN_MES_SOLICITADO_F JN_ANO_SOLICITADO_F
NAME JN_LENDO

AUTOPAGE FANTASMA
NAME JN_SALDO_INICIAL
NAME JN_CREDITO
NAME JN_DEBITO
NAME JN_SALDO_FINAL

OPEN ENTIDADE
OPEN PLANO
OPEN TEMPAUDE
OPEN ASSINATU
ABRE_CONTACOR ST@EXERCICIO@FINANCEIRO CONTACOR

MOVE PARGERAL.EXERCICIO    TO ST_EXERCICIO
MOVE PARGERAL.COD_ENTIDADE TO ST_COD_ENTIDADE

PAGE SET MSG       AT 05 01 COLORS IT_COR_TITULO IT_COR_TITULO
PAGE SET TELA      AT  4  0 COLORS IT_COR_TARJA  IT_COR_MOLDURA
PAGE SET CONFIRMA  AT 21 00 COLORS IT_COR_TARJA  IT_COR_MOLDURA

INICIO:
CLEARFORM TELA
PAGE TELA
MOVE PARGERAL.EXERCICIO TO JN_ANO_INICIAL
MOVE PARGERAL.EXERCICIO TO JN_ANO_FINAL

IF PARGERAL.COD_ENTIDADE EQ '01' BEGIN
 REPEAT
  ACCEPT JN_COD_ENTIDADE {AUTOCLEAR}
  [KEY.ESCAPE] ABORT
  IF JN_COD_ENTIDADE EQ '' MENSAGEM 1
  ELSE BEGIN
        COMZEROS JN_COD_ENTIDADE 2
        CLEAR ENTIDADE
        MOVE ST@EXERCICIO@FINANCEIRO TO ENTIDADE.EXERCICIO
        MOVE JN_COD_ENTIDADE         TO ENTIDADE.CODIGO
        FIND EQ ENTIDADE BY INDEX.1
        [~FOUND] BEGIN
                  ADVERTE 'ENTIDADE N▌O CADASTRADA'
                  CLEARFORM JN_COD_ENTIDADE THRU JN_ENTIDADE
                 END
       END
 UNTIL JN_COD_ENTIDADE NE ''
 MOVE ENTIDADE.DESCRICAO TO JN_ENTIDADE
 END
ELSE BEGIN
 MOVE PARGERAL.COD_ENTIDADE TO JN_COD_ENTIDADE
 CLEAR ENTIDADE
 MOVE ST@EXERCICIO@FINANCEIRO TO ENTIDADE.EXERCICIO
 MOVE JN_COD_ENTIDADE         TO ENTIDADE.CODIGO
 FIND EQ ENTIDADE BY INDEX.1
 [~FOUND] BEGIN
           ADVERTE 'ENTIDADE N▌O CADASTRADA'
           CLEARFORM JN_COD_ENTIDADE THRU JN_ENTIDADE
          END
 MOVE ENTIDADE.DESCRICAO TO JN_ENTIDADE
 END
MOVE JN_COD_ENTIDADE TO ST_COD_ENTIDADE

INDICATE TODAS! FALSE

LB_MES_I:
ACCEPT JN_MES_INICIAL {AUTOCLEAR}
[KEY.ESCAPE] ABORT
IF JN_MES_INICIAL EQ '' GOTO LB_MES_I
COMZEROS JN_MES_INICIAL 2
IF ((JN_MES_INICIAL LE 0) OR (JN_MES_INICIAL GT 14)) BEGIN
 ADVERTE 'M┬S INV═LIDO. TENTE NOVAMENTE.'
 CLEARFORM JN_MES_INICIAL
 GOTO LB_MES_I
 END

ANO_2000 JN_ANO_INICIAL {AUTOCLEAR}

LB_MES_F:
ACCEPT JN_MES_FINAL {AUTOCLEAR}
[KEY.ESCAPE] ABORT
IF JN_MES_FINAL EQ '' GOTO LB_MES_F
COMZEROS JN_MES_FINAL 2
IF ((JN_MES_FINAL LE 0) OR (JN_MES_FINAL GT 14)) BEGIN
 ADVERTE 'M┬S INV═LIDO. TENTE NOVAMENTE.'
 CLEARFORM JN_MES_FINAL
 GOTO LB_MES_F
 END

MOVE JN_ANO_INICIAL TO JN_ANO_FINAL

INDICATE NO_EXERCICIO! AS JN_ANO_INICIAL EQ PARGERAL.EXERCICIO

LB_CC:
ACCEPT JN_CC {AUTOCLEAR}
[KEY.ESCAPE] ABORT
IF JN_CC NE '' BEGIN
 COMZEROS JN_CC 2
 BUSCA_TBAUDESP 'RELACAO DE CONTAS CORRENTES' JN_CC JN_CONTA_CORRENTE
 [~@OK!] BEGIN
          ADVERTE 'CONTA CORRENTE INEXISTENTE'
          GOTO LB_CC
         END
 END
INDICATE TODOS! AS JN_CC EQ ''

INDICATE OK! TRUE

ACCEPT JN_CONTA_INICIAL {AUTOCLEAR}
[KEY.ESCAPE] ABORT
IF JN_CONTA_INICIAL EQ '' BEGIN
 MOVE '1' TO JN_CONTA_INICIAL
 INDICATE OK! FALSE
 END
PONTUA_CONTA_CONTABIL JN_CONTA_INICIAL 'I'

CLEAR PLANO
MOVE PARGERAL.ESTADO    TO PLANO.UF
MOVE JN_ANO_INICIAL     TO PLANO.ANO
MOVE JN_CONTA_INICIAL   TO PLANO.CODIGO
FIND EQ PLANO BY INDEX.1
MOVE PLANO.DESCRICAO TO JN_INICIAL

[ OK!] MOVE JN_CONTA_INICIAL TO JN_CONTA_FINAL
ACCEPT JN_CONTA_FINAL {AUTOCLEAR}
IF JN_CONTA_FINAL EQ '' MOVE '99999999999999' TO JN_CONTA_FINAL
[KEY.ESCAPE] ABORT
PONTUA_CONTA_CONTABIL JN_CONTA_FINAL 'F'

CLEAR PLANO
MOVE PARGERAL.ESTADO    TO PLANO.UF
MOVE JN_ANO_INICIAL     TO PLANO.ANO
MOVE JN_CONTA_FINAL     TO PLANO.CODIGO
FIND EQ PLANO BY INDEX.1
MOVE PLANO.DESCRICAO TO JN_FINAL

MOVE 'BAL.VERIFICACAO C/C-PERIODO ' TO ST_JUNTA
APPEND ST_JUNTA JN_MES_INICIAL '-' JN_ANO_INICIAL ' A ' JN_MES_FINAL '-' JN_ANO_FINAL
ABREREL ST_JUNTA '132C+'

MOVE JN_MES_INICIAL TO JN_MES_SOLICITADO_I
MOVE JN_ANO_INICIAL TO JN_ANO_SOLICITADO_I

MOVE JN_MES_FINAL   TO JN_MES_SOLICITADO_F
MOVE JN_ANO_FINAL   TO JN_ANO_SOLICITADO_F

DEFINE_CODIGO_RECEITA JN_ANO_INICIAL

PAGE TELA
PAGE MSG
GOTOXY 25 0

APAGA_TEMPAUDE ''

MOVE 1 TO PAGECOUNT
MOVE 0 TO RECCOUNT

IF JN_CC NE '' BEGIN
 MOVE JN_CC TO ST_CONTA_CORRENTE
 APPEND ST_CONTA_CORRENTE '-' JN_CONTA_CORRENTE
 END

CABEC ST@PREFEITURA          HEADER.1
PRINT JN_MES_INICIAL      TO HEADER.2
PRINT JN_ANO_INICIAL      TO HEADER.3
PRINT JN_MES_FINAL        TO HEADER.4
PRINT JN_ANO_FINAL        TO HEADER.5
CABEC JN_ENTIDADE            HEADER.6
SYSDATA                      HEADER.7
IF JN_CC EQ '' BLANKFORM     HEADER.8
ELSE CABEC ST_CONTA_CORRENTE HEADER.8
PRINT PAGECOUNT           TO HEADER.9
OUTPUT HEADER

MOVEALL 0 TO NB_TOTAL_SALDO_INICIAL NB_TOTAL_SALDO_FINAL

MOVE JN_MES_INICIAL TO IT_MES_INICIAL
MOVE JN_MES_FINAL   TO IT_MES_FINAL

CLEAR PLANO
CONSTRAINT_SET 1
CONSTRAIN PLANO.UF     EQ PARGERAL.ESTADO
CONSTRAIN PLANO.ANO    EQ JN_ANO_INICIAL
CONSTRAIN PLANO.CODIGO GE JN_CONTA_INICIAL
CONSTRAIN PLANO.CODIGO LE JN_CONTA_FINAL
[~TODOS!] CONSTRAIN PLANO.CONTA_CORRENTE EQ JN_CC
[ TODOS!] CONSTRAIN PLANO.CONTA_CORRENTE NE ''
CONSTRAIN PLANO.GRAU   LE '7'
CONSTRAINED_FIND FIRST PLANO BY INDEX.1
WHILE [FOUND]
 CALC (JN_LENDO + 1) TO JN_LENDO
 KEYCHECK GOSUB LB_ROTINA_PARADA

 MOVE PLANO.CONTA_CORRENTE TO ST_XML
 MOVE PLANO.CODIGO         TO ST_CONTA

 INDICATE  IMPRIME! FALSE
 
 MOVE 0 TO IT_AUX
  
 FOR IT_AUX FROM IT_MES_INICIAL TO JN_MES_FINAL
  MOVE IT_AUX TO ST_MES
  COMZEROS ST_MES 2

  CLEAR CONTACOR
  CONSTRAINT_SET 2
  CONSTRAIN CONTACOR.ANO          EQ JN_ANO_INICIAL
  CONSTRAIN CONTACOR.MES          EQ ST_MES
  CONSTRAIN CONTACOR.COD_ENTIDADE EQ ST_COD_ENTIDADE
  CONSTRAIN CONTACOR.XML          EQ ST_XML
  CONSTRAIN CONTACOR.CONTA        EQ ST_CONTA
  CONSTRAINED_FIND FIRST CONTACOR BY INDEX.2
  WHILE [FOUND]
   CALC (JN_LENDO + 1) TO JN_LENDO

   GOSUB LB_TRATA_DADOS
   TRIM ST_DESCRICAO TO ST_DESCRICAO

   MOVE CONTACOR.CONTA TO ST_DADOS
   APPEND ST_DADOS ' ' ST_DESCRICAO

   CLEAR TEMPAUDE
   MOVE ST@CODIGO@ENTIDADE      TO TEMPAUDE.COD_ENTIDADE
   MOVE ST@EXERCICIO@FINANCEIRO TO TEMPAUDE.EXERCICIO
   MOVE ST@USUARIO              TO TEMPAUDE.USUARIO
   MOVE ST_DADOS                TO TEMPAUDE.CODIGO
   MOVE 'CONFERE'               TO TEMPAUDE.NUMERO
   FIND EQ TEMPAUDE BY INDEX.1
   INDICATE ERR FALSE
   ON ERROR GOSUB CHECA_GRAVACAO
   [ FOUND] REREAD TEMPAUDE

   //--saldo inicial
   IF CONTACOR.MES EQ JN_MES_INICIAL BEGIN
                                      MOVE CONTACOR.NAT_INICIAL                             TO TEMPAUDE.AUXILIAR_1
                                      IF TEMPAUDE.AUXILIAR_2 EQ '' MOVE CONTACOR.NAT_FINAL  TO TEMPAUDE.AUXILIAR_2
                                      CALC (TEMPAUDE.VALOR + CONTACOR.VALOR)                TO TEMPAUDE.VALOR
                                     END
           
   //--movimentacao do periodo
   CALC (TEMPAUDE.VALOR_1 + CONTACOR.VALOR_1) TO TEMPAUDE.VALOR_1   //--DEBITOS
   CALC (TEMPAUDE.VALOR_2 + CONTACOR.VALOR_2) TO TEMPAUDE.VALOR_2   //--CREDITOS
   
   IF TEMPAUDE.AUXILIAR_1 EQ '' MOVE PLANO.SALDO_DC TO TEMPAUDE.AUXILIAR_1
   IF TEMPAUDE.AUXILIAR_2 EQ '' MOVE PLANO.SALDO_DC TO TEMPAUDE.AUXILIAR_2
  
   //--calculo do saldo final
   IF CONTACOR.MES EQ JN_MES_FINAL BEGIN
                                    IF TEMPAUDE.AUXILIAR_1 EQ '' MOVE CONTACOR.NAT_INICIAL TO TEMPAUDE.AUXILIAR_1
                                    MOVE CONTACOR.NAT_FINAL                                TO TEMPAUDE.AUXILIAR_2
                                    CALC (TEMPAUDE.VALOR_3 + CONTACOR.VALOR_3)             TO TEMPAUDE.VALOR_3
                                   END
   SAVERECORD TEMPAUDE
   UNLOCK
   ON ERROR OFF

   CONSTRAINED_FIND NEXT
   END
  CONSTRAINT_SET 2 CLEAR
 LOOP

 MOVEALL 0 TO NB_SALDO_INICIAL NB_SALDO_FINAL

 CLEAR TEMPAUDE
 CONSTRAINT_SET 3
 CONSTRAIN TEMPAUDE.COD_ENTIDADE EQ ST@CODIGO@ENTIDADE
 CONSTRAIN TEMPAUDE.EXERCICIO    EQ ST@EXERCICIO@FINANCEIRO
 CONSTRAIN TEMPAUDE.USUARIO      EQ ST@USUARIO
 CONSTRAIN TEMPAUDE.NUMERO       EQ 'CONFERE'
 CONSTRAINED_FIND FIRST TEMPAUDE BY INDEX.3
 WHILE [FOUND]
  CALC (JN_LENDO + 1) TO JN_LENDO

  PRINT (MID(TEMPAUDE.CODIGO,18,1))   TO JBD_CODIGO
  PRINT (MID(TEMPAUDE.CODIGO,182,20)) TO JBD_DESCRICAO
  PRINT TEMPAUDE.AUXILIAR_1           TO JBD_NATUREZA_INICIAL
  PRINT TEMPAUDE.VALOR                TO JBD_SALDO_INICIAL
  PRINT TEMPAUDE.VALOR_1              TO JBD_DEBITO
  PRINT TEMPAUDE.VALOR_2              TO JBD_CREDITO
  PRINT TEMPAUDE.VALOR_3              TO JBD_SALDO_FINAL
  PRINT TEMPAUDE.AUXILIAR_2           TO JBD_NATUREZA_FINAL
  
  IF JBD_SALDO_INICIAL LT 0 BEGIN
                             PRINT (JBD_SALDO_INICIAL * (-1)) TO JBD_SALDO_INICIAL
                             CALC  (TEMPAUDE.VALOR    * (-1)) TO TEMPAUDE.VALOR
                            END
  IF JBD_SALDO_FINAL   LT 0 BEGIN
                             PRINT (JBD_SALDO_FINAL   * (-1)) TO JBD_SALDO_FINAL
                             CALC  (TEMPAUDE.VALOR_3  * (-1)) TO TEMPAUDE.VALOR_3
                            END

  GOSUB LB_PULA_PAGINA

  
              INDICATE IMPRIME! AS JBD_SALDO_INICIAL NE 0
  [~IMPRIME!] INDICATE IMPRIME! AS JBD_SALDO_FINAL   NE 0
  [~IMPRIME!] INDICATE IMPRIME! AS JBD_DEBITO        NE 0
  [~IMPRIME!] INDICATE IMPRIME! AS JBD_CREDITO       NE 0
  [ IMPRIME!] BEGIN
               OUTPUT BODY
               INCREMENT RECCOUNT
              END

  IF PLANO.SALDO_DC EQ 'D' BEGIN
   IF TEMPAUDE.AUXILIAR_1 EQ 'D' CALC (NB_SALDO_INICIAL + TEMPAUDE.VALOR)   TO NB_SALDO_INICIAL
   ELSE                          CALC (NB_SALDO_INICIAL - TEMPAUDE.VALOR)   TO NB_SALDO_INICIAL
   IF TEMPAUDE.AUXILIAR_2 EQ 'D' CALC (NB_SALDO_FINAL   + TEMPAUDE.VALOR_3) TO NB_SALDO_FINAL
   ELSE                          CALC (NB_SALDO_FINAL   - TEMPAUDE.VALOR_3) TO NB_SALDO_FINAL
   END
  ELSE BEGIN
   IF TEMPAUDE.AUXILIAR_1 EQ 'C' CALC (NB_SALDO_INICIAL + TEMPAUDE.VALOR)   TO NB_SALDO_INICIAL
   ELSE                          CALC (NB_SALDO_INICIAL - TEMPAUDE.VALOR)   TO NB_SALDO_INICIAL
   IF TEMPAUDE.AUXILIAR_2 EQ 'C' CALC (NB_SALDO_FINAL   + TEMPAUDE.VALOR_3) TO NB_SALDO_FINAL
   ELSE                          CALC (NB_SALDO_FINAL   - TEMPAUDE.VALOR_3) TO NB_SALDO_FINAL
   END

  INDICATE ERR FALSE
  ON ERROR GOSUB CHECA_GRAVACAO
  REREAD TEMPAUDE
  DELETE TEMPAUDE
  UNLOCK
  ON ERROR OFF

  CONSTRAINED_FIND NEXT
  END
 CONSTRAINT_SET 3 CLEAR
 
 IF PLANO.SALDO_DC EQ 'D' BEGIN
  CALC (NB_TOTAL_SALDO_INICIAL + NB_SALDO_INICIAL) TO NB_TOTAL_SALDO_INICIAL
  CALC (NB_TOTAL_SALDO_FINAL   + NB_SALDO_FINAL)   TO NB_TOTAL_SALDO_FINAL
  END
 ELSE BEGIN
  CALC (NB_TOTAL_SALDO_INICIAL - NB_SALDO_INICIAL) TO NB_TOTAL_SALDO_INICIAL
  CALC (NB_TOTAL_SALDO_FINAL   - NB_SALDO_FINAL)   TO NB_TOTAL_SALDO_FINAL
  END

 GOSUB LB_PULA_PAGINA
 PRINT NB_SALDO_INICIAL     TO SUBTOTAL.1
 SUBTOTAL JBD_DEBITO        TO SUBTOTAL.2
 SUBTOTAL JBD_CREDITO       TO SUBTOTAL.3
 PRINT NB_SALDO_FINAL       TO SUBTOTAL.4

             INDICATE IMPRIME! AS SUBTOTAL.1 NE 0
 [~IMPRIME!] INDICATE IMPRIME! AS SUBTOTAL.2 NE 0
 [~IMPRIME!] INDICATE IMPRIME! AS SUBTOTAL.3 NE 0
 [~IMPRIME!] INDICATE IMPRIME! AS SUBTOTAL.4 NE 0
 [ IMPRIME!] OUTPUT SUBTOTAL

 CONSTRAINT_SET 1
 CONSTRAINED_FIND NEXT
 END
CONSTRAINT_SET 1 CLEAR


IF NB_TOTAL_SALDO_INICIAL LT 0 CALC (NB_TOTAL_SALDO_INICIAL * (-1)) TO NB_TOTAL_SALDO_INICIAL
IF NB_TOTAL_SALDO_FINAL   LT 0 CALC (NB_TOTAL_SALDO_FINAL   * (-1)) TO NB_TOTAL_SALDO_FINAL

GOSUB LB_PULA_PAGINA
PRINT NB_TOTAL_SALDO_INICIAL TO TOTAL.1
SUBTOTAL SUBTOTAL.2          TO TOTAL.2
SUBTOTAL SUBTOTAL.3          TO TOTAL.3
PRINT NB_TOTAL_SALDO_FINAL   TO TOTAL.4
OUTPUT TOTAL

IF RECCOUNT LE 0 BEGIN
                  SCREENMODE IT_COR_TITULO ON
                  GOTOXY 22 02
                  SHOW ' RELAT╒RIO N▌O IMPRESSO ! REGISTRO N▌O ENCONTRADO . TECLE <ENTER> PARA SAIR '
                  GOTOXY 25 0
                  INKEY ST_TECLA

                  INDICATE TITULO_R00CONF! TRUE
                 END
ELSE BEGIN
      #INCLUDE R00CONFE.INC
     END
     
BLANKFORM JT_ASSINATURA_1 THRU JT_CRC_5

IMPRIME_ASSINATURA '1 ' ST@PROGRAMA ST@CODIGO@ENTIDADE ST@EXERCICIO@FINANCEIRO

IF ST@ASSINATURA@TIPO1 EQ '1' BEGIN
 CLEARFORM                      JT_ASSINATURA_1
 CABEC ST@ASSINATURA@NOME1      JT_NOME_1
 CABEC ST@ASSINATURA@CARGO1     JT_CARGO_1
 CABEC ST@ASSINATURA@DOCUMENTO1 JT_CRC_1
END
IF ST@ASSINATURA@TIPO2 EQ '2' BEGIN
 CLEARFORM                      JT_ASSINATURA_2
 CABEC ST@ASSINATURA@NOME2      JT_NOME_2
 CABEC ST@ASSINATURA@CARGO2     JT_CARGO_2
 CABEC ST@ASSINATURA@DOCUMENTO2 JT_CRC_2
END
IF ST@ASSINATURA@TIPO3 EQ '3' BEGIN
 CLEARFORM                      JT_ASSINATURA_3
 CABEC ST@ASSINATURA@NOME3      JT_NOME_3
 CABEC ST@ASSINATURA@CARGO3     JT_CARGO_3
 CABEC ST@ASSINATURA@DOCUMENTO3 JT_CRC_3
END
IF ST@ASSINATURA@TIPO4 EQ '4' BEGIN
 CLEARFORM                      JT_ASSINATURA_4
 CABEC ST@ASSINATURA@NOME4      JT_NOME_4
 CABEC ST@ASSINATURA@CARGO4     JT_CARGO_4
 CABEC ST@ASSINATURA@DOCUMENTO4 JT_CRC_4
END
IF ST@ASSINATURA@TIPO5 EQ '5' BEGIN
 CLEARFORM                      JT_ASSINATURA_5
 CABEC ST@ASSINATURA@NOME5      JT_NOME_5
 CABEC ST@ASSINATURA@CARGO5     JT_CARGO_5
 CABEC ST@ASSINATURA@DOCUMENTO5 JT_CRC_5
END
OUTPUT ASSINATURAS

IF ((ST@ASSINATURA@TIPO1 EQ '1') OR (ST@ASSINATURA@TIPO2 EQ '2') OR (ST@ASSINATURA@TIPO3 EQ '3') OR (ST@ASSINATURA@TIPO4 EQ '4') OR (ST@ASSINATURA@TIPO5 EQ '5')) BEGIN
 IF LINECOUNT GE 56 BEGIN
                     GOSUB LB_PULA_PAGINA
                     OUTPUT FOOTER
                    END
END

BUSCA_CAMINHO_MENU 'BAUDES02' ''
FORMFEED
GRAVAPAG
APAGA_TEMPAUDE ''

[~TITULO_R00CONF!] BEGIN
                    ADVERTE 'VERIFIQUE, NO FIM DO RELATORIO, RELACAO DA(S) ENTIDADE(S) SEM ARQUIVO(S) XML REFERENTE AO PERIODO SELECIONADO.'
                   END

ABORT

LB_ROTINA_PARADA:
 CABEC 'GOSTARIA REALMENTE DE SAIR < S/N >?' CONFIRMA.1
 PAGE CONFIRMA
 INKEYCHECK ST_TECLA IN 'SsNn'
 IF ST_TECLA IN 'Ss' BEGIN
                      MOVE 0 TO RECCOUNT
                      LIMPA_PRN
                     END

 MOVE 0 TO CURRENT_IMAGE
 PAGE TELA
 PAGE MSG
RETURN

KEYPROC KEY.UP
 IF CURRENT_WINDOW EQ 3 BEGIN
  IF PARGERAL.COD_ENTIDADE EQ '01' BEGIN
   BACKFIELD
  END
  ELSE BEGIN
   RETURN LB_MES_I
  END
 END
 ELSE BEGIN
  BACKFIELD
 END
RETURN

KEYPROC KEY.FIELD
IF CURRENT_WINDOW EQ 1 BEGIN
                        MOVE 'CENTIDAD 1 ' TO ST_JUNTA
                        APPEND ST_JUNTA ST@USUARIO ' ' ST@OPCAO ' ' ST@PROGRAMA ' ' ST@CODIGO@ENTIDADE ' ' ST@EXERCICIO@FINANCEIRO
                        CHAIN WAIT ST_JUNTA EXPORT_FILES
                        MOVE 0 TO CURRENT_IMAGE
                        PAGE TELA
                        IF ENTIDADE.CODIGO NE "" BEGIN
                                                  TRIM ENTIDADE.CODIGO    TO JN_COD_ENTIDADE
                                                  TRIM ENTIDADE.DESCRICAO TO JN_ENTIDADE
                                                 END
                        ELSE ENTAGAIN
                        RETURN
                       END
ELSE IF CURRENT_WINDOW EQ 7 BEGIN
                             MOVE 'CBUSCATB 1 ' TO ST_JUNTA
                             APPEND ST_JUNTA ST@USUARIO ' ' ST@OPCAO ' ' ST@PROGRAMA ' ' ST@CODIGO@ENTIDADE ' ' ST@EXERCICIO@FINANCEIRO ' ' 'RELACAO@DE@CONTAS@CORRENTES'
                             CHAIN WAIT ST_JUNTA EXPORT_FILES
                             MOVE 0 TO CURRENT_IMAGE
                             PAGE TELA
                             IF TBAUDESP.CODIGO NE "" MOVE TBAUDESP.CODIGO TO JN_CC
                             ELSE ENTAGAIN
                             RETURN
                            END
ELSE IF CURRENT_WINDOW EQ 9 BEGIN
                             MOVE 'CCONTAS2 1 ' TO ST_JUNTA
                             APPEND ST_JUNTA ST@USUARIO ' ' ST@OPCAO ' ' ST@PROGRAMA ' ' ST@CODIGO@ENTIDADE ' ' ST@EXERCICIO@FINANCEIRO ' ' JN_ANO_INICIAL
                             CHAIN WAIT ST_JUNTA EXPORT_FILES
                             MOVE 0 TO CURRENT_IMAGE
                             PAGE TELA
                             IF PLANO.CODIGO NE '' BEGIN
                                                    MOVE PLANO.CODIGO TO JN_CONTA_INICIAL
                                                   END
                             ELSE ENTAGAIN
                             RETURN
                            END
ELSE IF CURRENT_WINDOW EQ 11 BEGIN
                              MOVE 'CCONTAS2 1 ' TO ST_JUNTA
                              APPEND ST_JUNTA ST@USUARIO ' ' ST@OPCAO ' ' ST@PROGRAMA ' ' ST@CODIGO@ENTIDADE ' ' ST@EXERCICIO@FINANCEIRO ' ' JN_ANO_INICIAL
                              CHAIN WAIT ST_JUNTA EXPORT_FILES
                              MOVE 0 TO CURRENT_IMAGE
                              PAGE TELA
                              IF PLANO.CODIGO NE '' BEGIN
                                                     MOVE PLANO.CODIGO TO JN_CONTA_FINAL
                                                    END
                              ELSE ENTAGAIN
                              RETURN
                             END
ELSE ENTAGAIN
RETURN

LB_PULA_PAGINA:
 IF LINECOUNT GE 54 BEGIN
  OUTPUT FOOTER
  FORMFEED
  PRINT PAGECOUNT TO HEADER.9
  OUTPUT HEADER
  END
RETURN

LB_TRATA_DADOS:
 MOVE '' TO ST_DESCRICAO
 IF CONTACOR.XML EQ '01' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,2,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,26))
  END
 ELSE IF CONTACOR.XML EQ '02' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,3,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,24))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.AUXILIAR,1,1))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,20,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.AUXILIAR,1,3))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,61))
  END
 ELSE IF CONTACOR.XML EQ '03' BEGIN
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,20,20))
  END
 ELSE IF CONTACOR.XML EQ '04' BEGIN
  APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,14,20))
  END
 ELSE IF CONTACOR.XML EQ '05' BEGIN
  [~@NOVO_CNR!] APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,13,20))
  [ @NOVO_CNR!] APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,14,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,37))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,43))
  END
 ELSE IF CONTACOR.XML EQ '06' BEGIN
  [~@NOVO_CNR!] APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,13,20))
  [ @NOVO_CNR!] APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,14,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,37))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,43))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,51))
  END
 ELSE IF CONTACOR.XML EQ '07' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,3,41))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,45))

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,50))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,68))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,74))
  END
 ELSE IF CONTACOR.XML EQ '08' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,3,41))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,45))

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,50))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,68))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,74))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,82))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,93))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,25,96))
  END
 ELSE IF CONTACOR.XML EQ '09' BEGIN
  MOVE (MID(CONTACOR.DADOS,12,82))  TO ST_N_EMPENHO
  MOVE (MID(CONTACOR.DADOS,4,95))   TO ST_ANO_EMPENHO
  MOVE (MID(CONTACOR.DADOS,2,100))  TO ST_TIPO_EMPENHO
  MOVE (MID(CONTACOR.DADOS,12,103)) TO ST_REGIME_DESPESA
  MOVE (MID(CONTACOR.DADOS,2,116))  TO ST_MODALIDADE_LICITACAO
  MOVE (MID(CONTACOR.DADOS,2,155))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,158)) TO ST_N_INSCRICAO
  
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,3,41))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,45))

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,50))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,68))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,74))

  APPEND ST_DESCRICAO ' ' ST_N_EMPENHO
  APPEND ST_DESCRICAO ' ' ST_ANO_EMPENHO
  APPEND ST_DESCRICAO ' ' ST_TIPO_EMPENHO
  APPEND ST_DESCRICAO ' ' ST_TIPO_INSCRICAO ' ' ST_N_INSCRICAO

  APPEND ST_DESCRICAO ' ' ST_REGIME_DESPESA
  APPEND ST_DESCRICAO ' ' ST_MODALIDADE_LICITACAO

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,20,118)) '/' (MID(CONTACOR.DADOS,4,139))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,144))

  END
 ELSE IF CONTACOR.XML EQ '10' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '11' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '12' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,1,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,22))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,28))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,36))
  END
 ELSE IF CONTACOR.XML EQ '14' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '15' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '16' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '17' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '18' BEGIN
  [~@NOVO_CNR!] APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,13,20))
  [ @NOVO_CNR!] APPEND ST_DESCRICAO (MID(CONTACOR.DADOS,14,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,37))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,43))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,51))
//  APPEND ST_DESCRICAO ' ' '--' (MID(CONTACOR.DADOS,5,56))
  END
 ELSE IF CONTACOR.XML EQ '19' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,73))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,76)) TO ST_N_INSCRICAO

  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,56))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,62))
  APPEND ST_DESCRICAO ' ' ST_TIPO_INSCRICAO ' ' ST_N_INSCRICAO
  END
 ELSE IF CONTACOR.XML EQ '20' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,73))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,76)) TO ST_N_INSCRICAO

  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,56))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,62))
  APPEND ST_DESCRICAO ' ' ST_TIPO_INSCRICAO ' ' ST_N_INSCRICAO
  END
 ELSE IF CONTACOR.XML EQ '21' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,73))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,76)) TO ST_N_INSCRICAO

  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,56))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,62))
  APPEND ST_DESCRICAO ' ' ST_TIPO_INSCRICAO ' ' ST_N_INSCRICAO
  END
 ELSE IF CONTACOR.XML EQ '22' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,49))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,52)) TO ST_N_INSCRICAO

  MOVE ST_TIPO_INSCRICAO TO ST_DESCRICAO
  APPEND ST_DESCRICAO ' ' ST_N_INSCRICAO

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,33))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,38))
  
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,73))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,76))
  END
 ELSE IF CONTACOR.XML EQ '23' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,49))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,52)) TO ST_N_INSCRICAO

  MOVE ST_TIPO_INSCRICAO TO ST_DESCRICAO
  APPEND ST_DESCRICAO ' ' ST_N_INSCRICAO
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,33))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,38))
  
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,73))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,76))
  END
 ELSE IF CONTACOR.XML EQ '24' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,49))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,52)) TO ST_N_INSCRICAO

  MOVE ST_TIPO_INSCRICAO TO ST_DESCRICAO
  APPEND ST_DESCRICAO ' ' ST_N_INSCRICAO
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,33))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,38))
  
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,73))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,76))
  END
 ELSE IF CONTACOR.XML EQ '25' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,38))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,41)) TO ST_N_INSCRICAO

  MOVE ST_TIPO_INSCRICAO TO ST_DESCRICAO
  APPEND ST_DESCRICAO ' ' ST_N_INSCRICAO
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,33))
  END
 ELSE IF CONTACOR.XML EQ '26' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,3,41))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,45))

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,50))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,105))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,111))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,20,68)) '/' (MID(CONTACOR.DADOS,4,89))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,94))
  END
 ELSE IF CONTACOR.XML EQ '27' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,3,41))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,45))

  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,50))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,68))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,74))

  APPEND ST_DESCRICAO ' ' (TRIM(CONTACOR.AUXILIAR)) //--TIPO CONVENIO
  END
 ELSE IF CONTACOR.XML EQ '28' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  END
 ELSE IF CONTACOR.XML EQ '29' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,51))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,56))
  END
 ELSE IF CONTACOR.XML EQ '30' BEGIN
  IF PARGERAL.EXERCICIO LE '2019' BEGIN
                                   APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
                                   APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
                                  END
  ELSE BEGIN
        APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,1))
        APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,20))
        APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,39))
        APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,50))
        APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,56))
        APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,1,62))
       END
  END
 ELSE IF CONTACOR.XML EQ '31' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,40))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,3,43))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,47))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,52))
  END
 ELSE IF CONTACOR.XML EQ '32' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  END
 ELSE IF CONTACOR.XML EQ '33' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,44))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,52))
  END
 ELSE IF CONTACOR.XML EQ '34' BEGIN
  APPEND ST_DESCRICAO     (MID(CONTACOR.DADOS,5,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,5,32))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,38))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,44))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,52))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,55))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,58))
  END
 ELSE IF CONTACOR.XML EQ '35' BEGIN
  MOVE (MID(CONTACOR.DADOS,2,61))  TO ST_TIPO_INSCRICAO
  MOVE (MID(CONTACOR.DADOS,20,64)) TO ST_N_INSCRICAO

  MOVE ST_TIPO_INSCRICAO TO ST_DESCRICAO
  APPEND ST_DESCRICAO ' ' ST_N_INSCRICAO
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,2,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,7,26))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,12,34))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,4,47))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.AUXILIAR,10,1))
  END
 ELSE IF CONTACOR.XML EQ '36' BEGIN
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,1))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,39))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,1,50))
  
  IF CONTACOR.SEQUENCIA NE 0 APPEND ST_DESCRICAO ' ' CONTACOR.SEQUENCIA
  END
 ELSE IF CONTACOR.XML EQ '37' BEGIN
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,1))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,39))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,1,50))
  
  IF CONTACOR.SEQUENCIA NE 0 APPEND ST_DESCRICAO ' ' CONTACOR.SEQUENCIA
  END
 ELSE IF CONTACOR.XML EQ '38' BEGIN
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,1))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,18,20))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,10,39))
  APPEND ST_DESCRICAO ' ' (MID(CONTACOR.DADOS,1,50))
  
  IF CONTACOR.SEQUENCIA NE 0 APPEND ST_DESCRICAO ' ' CONTACOR.SEQUENCIA
  END
RETURN


#INCLUDE INTEGRID.INC




