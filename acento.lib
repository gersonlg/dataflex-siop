#COMMAND RETIRAR_ACENTUACAO
#IFDEF    ST@NOME@ACENTO
#ELSE
   STRING ST@NOME@ACENTO 255
#ENDIF

 MOVE !1 TO ST@NOME@ACENTO
 
 MOVE (REPLACES('Í',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ý',(TRIM(ST@NOME@ACENTO)),'a.'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('™',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('€',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('æ',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('·',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ª',(TRIM(ST@NOME@ACENTO)),'a.'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('á',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ã',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('à',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('â',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Á',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('À',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Â',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('é',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ê',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('É',(TRIM(ST@NOME@ACENTO)),'E' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ê',(TRIM(ST@NOME@ACENTO)),'E' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('í',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Í',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ó',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('õ',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ô',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ó',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Õ',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ô',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ú',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ü',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ú',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ü',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('ç',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ç',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('©',(TRIM(ST@NOME@ACENTO)),''  ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('®',(TRIM(ST@NOME@ACENTO)),''  ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('º',(TRIM(ST@NOME@ACENTO)),'o.'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ž',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('€',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('€',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('¶',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ö',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('µ',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('”',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('™',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Á',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('',(TRIM(ST@NOME@ACENTO)),'E' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('µ',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('€',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('à',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('å',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ö',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('â',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('é',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('š',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ò',(TRIM(ST@NOME@ACENTO)),'E' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ú',(TRIM(ST@NOME@ACENTO)),'U' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('É',(TRIM(ST@NOME@ACENTO)),'E' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Â',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ó',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Í',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('è',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('º',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('™',(TRIM(ST@NOME@ACENTO)),'I' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('€',(TRIM(ST@NOME@ACENTO)),'C' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('æ',(TRIM(ST@NOME@ACENTO)),'A' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('·',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Œ',(TRIM(ST@NOME@ACENTO)),'O' ))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã“',(TRIM(ST@NOME@ACENTO)),'O'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã',(TRIM(ST@NOME@ACENTO)),'I'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã',(TRIM(ST@NOME@ACENTO)),'A'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã‚',(TRIM(ST@NOME@ACENTO)),'A'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('Ã‡Ãƒ',(TRIM(ST@NOME@ACENTO)),'A')) TO ST@NOME@ACENTO
 MOVE (REPLACES('?',(TRIM(ST@NOME@ACENTO)),'C'))    TO ST@NOME@ACENTO
 MOVE (REPLACES('§',(TRIM(ST@NOME@ACENTO)),'o.'))   TO ST@NOME@ACENTO
 MOVE (REPLACES('a',(TRIM(ST@NOME@ACENTO)),'A'))    TO ST@NOME@ACENTO
 MOVE (REPLACES('¡',(TRIM(ST@NOME@ACENTO)),'I'))    TO ST@NOME@ACENTO
 MOVE (REPLACES(' ',(TRIM(ST@NOME@ACENTO)),'A'))    TO ST@NOME@ACENTO
 MOVE (REPLACES('ƒ',(TRIM(ST@NOME@ACENTO)),'A'))    TO ST@NOME@ACENTO
 MOVE (REPLACES('A',(TRIM(ST@NOME@ACENTO)),'A'))    TO ST@NOME@ACENTO
 MOVE (REPLACES("'",(TRIM(ST@NOME@ACENTO)),''))     TO ST@NOME@ACENTO
 MOVE (REPLACES('   ',(TRIM(ST@NOME@ACENTO)),' '))  TO ST@NOME@ACENTO
 MOVE (REPLACES('  ',(TRIM(ST@NOME@ACENTO)),' '))   TO ST@NOME@ACENTO
 MOVE (REPLACES("³",(TRIM(ST@NOME@ACENTO)),'A'))     TO ST@NOME@ACENTO
 
 TRIM ST@NOME@ACENTO TO !2
 
#ENDCOMMAND

//--
//-- !1 - arquivo origem
//-- !2 - arquivo destino
//--
#COMMAND TIRAR_ACENTUACAO_ARQUIVO
#IFDEF    ST@COMANDO
#ELSE
   STRING ST@COMANDO 255
#ENDIF

 //--cria sh com comando para retirar acentuacoes
 DIRECT_OUTPUT "tirar_acentuacao_arquivo.sh"
 WRITELN "iconv -t ASCII/\/TRANSLIT/\/IGNORE "  !1 " > " !2
 WRITELN "mv " !2 " " !1
 CLOSE_OUTPUT
 
 //--executa o sh e deleta em seguida
 MOVE ". ./tirar_acentuacao_arquivo.sh" TO ST@COMANDO
 RUNPROGRAM WAIT ST@COMANDO
 ERASEFILE "tirar_acentuacao_arquivo.sh"
#ENDCOMMAND

//--
//--retorna nome somente com a primeira letra em maiuscula
//--
FUNCTION PRIMEIRA_MAIUSCULA GLOBAL STRING ST@AUX@PARAMETRO RETURNS STRING
  LOCAL STRING  ST@RESULTADO ST@LETRA
  LOCAL INTEGER IT@AUX IT@CONTADOR IT@AUX@PARAMETRO
  
  LENGTH (TRIM(ST@AUX@PARAMETRO)) TO IT@AUX@PARAMETRO
  
  MOVE '' TO ST@RESULTADO
  LOWERCASE ST@AUX@PARAMETRO TO ST@AUX@PARAMETRO
  TRIM      ST@AUX@PARAMETRO TO ST@AUX@PARAMETRO
  MOVE 1 TO IT@AUX

  FOR IT@CONTADOR FROM 1 TO IT@AUX@PARAMETRO
   MOVE (MID(ST@AUX@PARAMETRO,1,IT@CONTADOR)) TO ST@LETRA
   IF ST@LETRA EQ ''  MOVE 0 TO IT@AUX
   IF ST@LETRA EQ '.' MOVE 0 TO IT@AUX
   IF IT@AUX EQ 1 UPPERCASE ST@LETRA
   ELSE           LOWERCASE ST@LETRA
   APPEND ST@RESULTADO ST@LETRA
   INCREMENT IT@AUX
  LOOP
  
  MOVE (REPLACES(' Do ',ST@RESULTADO,' do '))   TO ST@RESULTADO
  MOVE (REPLACES(' Da ',ST@RESULTADO,' da '))   TO ST@RESULTADO
  MOVE (REPLACES(' Dos ',ST@RESULTADO,' dos ')) TO ST@RESULTADO
  MOVE (REPLACES(' Das ',ST@RESULTADO,' das ')) TO ST@RESULTADO
  MOVE (REPLACES(' De ',ST@RESULTADO,' de '))   TO ST@RESULTADO
  MOVE (REPLACES(' E ',ST@RESULTADO,' e '))     TO ST@RESULTADO
  MOVE (REPLACES(' Ou ',ST@RESULTADO,' ou '))   TO ST@RESULTADO
  MOVE (REPLACES('\',ST@RESULTADO,''))          TO ST@RESULTADO
  
  TRIM ST@RESULTADO TO ST@RESULTADO
  
  FUNCTION_RETURN ST@RESULTADO
END_FUNCTION
